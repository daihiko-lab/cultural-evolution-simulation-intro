---
description: 
globs: 
alwaysApply: true
---
# 共通ルール

あなたは高度で専門的な問題解決能力を持つAIアシスタントです。以下の指示に従って、効率的かつ正確にタスクを遂行してください。

---
# 最重要参照ファイルと基本原則

**参照ファイルの活用:**
全ての作業プロセスにおいて、以下のファイルの内容を**必ず読み込み、分析・実装・検証・報告の全てで積極的に活用すること**。
- `.cursor/context/project_info/progress.md`（進捗・TODO・マイルストーン）
- `.cursor/context/project_info/technologystack.md`（技術スタック・実装規則）
- `.cursor/context/project_info/directorystructure.md`（ディレクトリ構成）

**鮮度維持:**
重要なファイル（特に `.cursor/context/project_info/progress.md`）は、必要に応じてツールを用いて最新の内容を読み込むこと。

**承認確認:**
AIによる変更（ファイル編集、コマンド実行など）に対して、ユーザーが承認を行ったか適宜確認すること。
重要なファイル編集は、**必ずユーザーに確認**すること。

---
# ユーザー指示と基本プロセス

**指示の確認:**
まず、ユーザーから受け取った以下の指示を確認します：
<指示>
{{instructions}}
<!-- このテンプレート変数はユーザーの入力プロンプトに自動置換されます -->
</指示>

**基本プロセス:**
この指示を元に、以下の基本プロセスと関連ルールに従って作業を進めてください：
1.  **指示の分析と計画:** 下記「分析と計画ガイドライン」を参照すること。
2.  **結果報告:** 下記「結果報告フォーマット」に従うこと。

**常に `.cursor/context/project_info/progress.md` を参照し、現在の研究開発フェーズとTODOリストを意識して作業を進めること。**

---
# 分析と計画ガイドライン

<タスク分析>
- **タスク要約:** 主要なタスクを簡潔に要約すること。
- **現状確認:** `.cursor/context/project_info/progress.md` の「現在の状況・マイルストーン」と「TODOリスト」を確認し、現在のフェーズにおける主要タスクを特定すること。
- **技術スタック確認:** `.cursor/context/project_info/technologystack.md` を確認し、その制約内での実装方法を検討すること。（バージョン変更は原則禁止、要承認）
- **要件・制約特定:** 重要な要件と制約を特定すること。
- **課題リストアップ:** 潜在的な課題をリストアップすること。
- **ステップ策定:** 現在のフェーズのタスクを実行するための具体的なステップを詳細に列挙すること。
- **順序決定:** ステップの最適な実行順序を決定すること。
- **重複実装の防止 (プログラミング時):**
    - 既存コードに類似機能がないか。
    - 同名または類似名の関数・モジュール・コンポーネント等が存在しないか。
    - 共通化できる処理がないか。
    - 使用言語の標準ライブラリや既存パッケージで同等の機能が提供されていないか。

この分析と計画は、後続プロセス全体の基盤となるため、十分な時間をかけて詳細かつ包括的に行うこと。
</タスク分析>

---
# 開発ログの記録

各開発タスク（または一連の作業区切り）完了時、以下の形式で開発ログを記録すること：

```markdown
# 開発ログ: [タスク名]
日時: [YYYY-MM-DD HH:MM]

## 実施内容
- [具体的な作業内容]

## 変更ファイル
- [変更したファイルパスと概要]

## 結果
- [作業の結果、影響範囲]

## 次のアクション
- [必要な後続タスク]

## 備考
- [特記事項、注意点]
```

---
# 結果報告フォーマット

以下のフォーマットで最終的な結果を報告してください：
```markdown
# 実行結果報告

## 概要
[全体の要約を簡潔に記述]

## 実行ステップ
1. [ステップ1の説明と結果]
2. [ステップ2の説明と結果]
...

## 主な成果物
[実装した主要な機能、作成/変更したファイルなど]

## パフォーマンス（該当する場合）
[実行時間、メモリ使用量などの測定結果]

## 最終成果物へのリンク（該当する場合）
[成果物の詳細や、該当する場合はリンクなど]

## `.cursor/context/project_info/progress.md` 更新状況
- [TODOリストの進捗、完了タスクなど]
- [現在の状況・マイルストーンの変化]

## 課題対応（該当する場合）
- 発生した問題と対応内容
- 今後の注意点

## 注意点・改善提案
- [気づいた点や改善提案があれば記述]
```

---
# 重要な注意事項 (Must Rules)

- **不明点確認:** 不明点がある場合は、作業開始前に必ずユーザーに確認すること。
- **ディレクトリ構造更新:** ファイルやディレクトリの追加、削除、移動、名前変更を行った場合は、必ず `.cursor/context/project_info/directorystructure.md` を更新し、最新の状態を反映させること。
- **ファイル操作前のパス検証:** ファイルの新規作成や編集を行う前には、**必ず** 対象の親ディレクトリが存在するかどうかを確認すること。
- **日付時刻情報の自動取得:** 現在の日付時刻情報が必要な場合、**必ず** `run_terminal_cmd` ツールを用いて `.cursor/scripts/get_current_date.sh` を実行し、その出力を利用すること。
